# Claude Code v2.0.60

Released: 2025-12-06 (estimated from changelog)

## Changes

- Added background agent support - agents run in the background while you work
- Added `--disable-slash-commands` CLI flag to disable all slash commands
- Added model name to "Co-Authored-By" commit messages
- Enabled `/mcp enable [server-name]` or `/mcp disable [server-name]` to quickly toggle MCP servers
- Updated Fetch to skip summarization for pre-approved websites
- VSCode: Added support for multiple terminal clients connecting to the IDE server simultaneously

## Background Agents - Deep Dive

v2.0.60 で導入された Background Agents は、Claude Code が自律的に作業を行うための3つの主要コンポーネントの一部。

### 全体アーキテクチャ

Claude Code の自律作業エコシステムは以下で構成される:

1. **Background Tasks** - 長時間実行プロセスをバックグラウンドで継続
2. **Subagents** - 特定タスクを独立して処理する専門AIエージェント
3. **Checkpoints** - 安全なリバートのための自動コード状態追跡

### Background Tasks

長時間実行コマンド（dev server、build tools、test runner等）をバックグラウンド化:

**使用方法:**
- `Ctrl+B` - 実行中のコマンドをバックグラウンドに移動（Tmuxユーザーは `Ctrl+B` を2回）
- Claude に直接「バックグラウンドで実行して」と依頼
- Web版では、メッセージの先頭に `&` を付ける

**特徴:**
- コマンドが非同期実行され、Claude は他の作業を継続可能
- 出力は BashOutput ツールで取得可能
- 各バックグラウンドタスクは一意のIDで追跡
- セッション終了時に自動クリーンアップ

**一般的なユースケース:**
- Webpack、Vite 等のビルドツール
- npm、yarn、pnpm 等のパッケージマネージャ
- jest、pytest 等のテストランナー
- 開発サーバー
- Docker、Terraform 等の長時間プロセス

### Subagents

独立して動作する事前設定済みAIアシスタント:

**設定項目:**
- 独立した**コンテキストウィンドウ**（メイン会話の汚染防止）
- カスタム**システムプロンプト**
- 制限された**ツールアクセス**
- **モデル選択**（Sonnet、Opus、Haiku、または継承）

**組み込みサブエージェント:**
- **Explore subagent** - 高速な読み取り専用コードベース分析（Haikuモデル使用）
- **General-purpose subagent** - 探索と修正を要するマルチステップタスク（Sonnetモデル使用）
- **Plan subagent** - プランモード中の調査と情報収集

**カスタムサブエージェントの作成:**

ファイルベース（`.claude/agents/my-agent.md`）:
```markdown
---
name: my-agent
description: このサブエージェントを呼び出すべき状況の説明
tools: Read, Grep, Glob, Bash
model: sonnet
---

あなたは[特定タスク]に特化したAIアシスタントです。
```

インタラクティブ（推奨）:
```
/agents
[Create New Agent を選択]
[目的とツールを説明]
```

### Checkpoints

Claude の編集を自動追跡し、安全な自律作業を実現:

**仕組み:**
- 各ユーザープロンプトで新しいチェックポイントを作成
- セッション間で永続化（会話の再開が可能）
- 30日後に自動クリーンアップ（設定可能）

**巻き戻し機能:**
`Esc + Esc` または `/rewind` で:
- コードのみ復元（会話は維持）
- 会話のみ復元（コード変更は維持）
- 両方を前のチェックポイントに復元

### 制限事項

- **Bash コマンドによる変更は追跡されない** - `rm`、`mv`、`cp` 等
- **外部変更は追跡されない** - Claude Code 外での手動編集
- **バージョン管理の代替ではない** - Git は依然として永続履歴に必要
- **バックグラウンドトークン使用** - セッションあたり約 $0.04 未満

### 参考リンク

- [Enabling Claude Code to work more autonomously](https://www.anthropic.com/news/enabling-claude-code-to-work-more-autonomously)
- [Interactive Mode Documentation](https://code.claude.com/docs/en/interactive-mode.md)
- [Subagents Documentation](https://code.claude.com/docs/en/sub-agents.md)
- [Checkpointing Documentation](https://code.claude.com/docs/en/checkpointing.md)

## Previous Version

- v2.0.59: `--agent` CLI flag, agent configuration setting
